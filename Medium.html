<!DOCTYPE html>
<html lang="en" style="background: black;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thoughts</title>
    <style>
        html, body {
            background-color: black;
            color: white;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .container {
            background: black;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(255, 255, 255, 0.1);
            padding: 20px;
            border: 1px solid #333;
        }

        .toolbar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .document-selector {
            margin-bottom: 20px;
        }

        input[type="text"] {
            padding: 12px;
            border: 1px solid #333;
            border-radius: 4px;
            flex-grow: 1;
            background: black;
            color: white;
            font-size: 16px;
        }

        select {
            padding: 12px;
            border: 1px solid #333;
            border-radius: 4px;
            width: 100%;
            background: black;
            color: white;
            font-size: 16px;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: #0066cc;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }

        button.delete {
            background-color: #dc3545;
        }

        button:hover {
            opacity: 0.9;
        }

        button:disabled {
            background-color: #333;
            cursor: not-allowed;
        }

        .editor-container {
            background: black;
            width: 100%;
            height: 500px;
            border: 1px solid #333;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        #editor {
            width: 100%;
            height: 100%;
            padding: 16px;
            border: none;
            resize: none;
            color: #00ff00;
            background: black;
            font-family: monospace;
            font-size: 18px;
            line-height: 1.4;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            background: #111;
            border-radius: 4px;
            margin-top: 10px;
            color: white;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="toolbar">
            <input type="text" id="documentTitle" placeholder="Document Title">
            <button onclick="saveDocument()">Save</button>
            <button onclick="downloadFile()">Download .txt</button>
            <button onclick="createNewDocument()">New</button>
            <button onclick="deleteDocument()" class="delete" id="deleteButton" disabled>Delete</button>
        </div>

        <div class="document-selector">
            <select id="documentList" onchange="loadDocument(this.value)">
                <option value="">Select a document</option>
            </select>
        </div>

        <div class="editor-container">
            <textarea id="editor" placeholder="Start typing..."></textarea>
        </div>

        <div class="status-bar">
            <span id="autoSaveStatus">Auto-save: On</span>
            <span id="lastSaved"></span>
        </div>
    </div>

    <script>
        let currentDoc = { id: '', title: '', content: '' };
        let autoSaveTimer = null;
        const AUTO_SAVE_DELAY = 3000;

        window.onload = function() {
            loadDocumentList();
            setupAutoSave();
            setupEditor();
        };

        function setupEditor() {
            const editor = document.getElementById('editor');
            editor.addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    e.preventDefault();  // Prevent losing focus
                    const start = this.selectionStart;
                    const end = this.selectionEnd;
                    
                    // Insert tab at cursor position or for selected text
                    this.value = this.value.substring(0, start) + "\t" + this.value.substring(end);
                    
                    // Move cursor after tab
                    this.selectionStart = this.selectionEnd = start + 1;
                }
            });
        }

        function setupAutoSave() {
            const editor = document.getElementById('editor');
            editor.addEventListener('input', () => {
                clearTimeout(autoSaveTimer);
                autoSaveTimer = setTimeout(() => {
                    if (currentDoc.id) {
                        saveDocument(true);
                        updateLastSaved();
                    }
                }, AUTO_SAVE_DELAY);
            });
        }

        function updateLastSaved() {
            const lastSaved = document.getElementById('lastSaved');
            lastSaved.textContent = `Last saved: ${new Date().toLocaleTimeString()}`;
        }

        function downloadFile() {
            const content = document.getElementById('editor').value;
            const title = document.getElementById('documentTitle').value.trim() || 'untitled';
            
            const blob = new Blob([content], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `${title}.txt`;
            
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            URL.revokeObjectURL(a.href);
        }

        function loadDocumentList() {
            const documents = getDocuments();
            const select = document.getElementById('documentList');
            select.innerHTML = '<option value="">Select a document</option>';
            
            documents.forEach(doc => {
                const option = document.createElement('option');
                option.value = doc.id;
                option.textContent = doc.title;
                select.appendChild(option);
            });
        }

        function getDocuments() {
            const docs = localStorage.getItem('documents');
            return docs ? JSON.parse(docs) : [];
        }

        function saveDocument(isAutoSave = false) {
            const titleInput = document.getElementById('documentTitle');
            const title = titleInput.value.trim();
            
            if (!title && !isAutoSave) {
                alert('Please enter a document title');
                return;
            }

            const content = document.getElementById('editor').value;
            const documents = getDocuments();

            const newDoc = {
                id: currentDoc.id || Date.now().toString(),
                title: title || 'Untitled',
                content: content,
                lastModified: new Date().toISOString()
            };

            if (currentDoc.id) {
                const index = documents.findIndex(doc => doc.id === currentDoc.id);
                if (index !== -1) {
                    documents[index] = newDoc;
                } else {
                    documents.push(newDoc);
                }
            } else {
                documents.push(newDoc);
            }

            localStorage.setItem('documents', JSON.stringify(documents));
            currentDoc = newDoc;
            
            // Update UI
            loadDocumentList();
            document.getElementById('documentList').value = newDoc.id;
            document.getElementById('deleteButton').disabled = false;

            if (!isAutoSave) {
                updateLastSaved();
            }
        }

        function loadDocument(docId) {
            if (!docId) {
                createNewDocument();
                return;
            }

            const documents = getDocuments();
            const doc = documents.find(d => d.id === docId);
            
            if (doc) {
                currentDoc = doc;
                document.getElementById('documentTitle').value = doc.title;
                document.getElementById('editor').value = doc.content;
                document.getElementById('deleteButton').disabled = false;
            }
        }

        function createNewDocument() {
            currentDoc = { id: '', title: '', content: '' };
            document.getElementById('documentTitle').value = '';
            document.getElementById('editor').value = '';
            document.getElementById('documentList').value = '';
            document.getElementById('deleteButton').disabled = true;
        }

        function deleteDocument() {
            if (!currentDoc.id) return;

            if (confirm('Are you sure you want to delete this document?')) {
                const documents = getDocuments().filter(doc => doc.id !== currentDoc.id);
                localStorage.setItem('documents', JSON.stringify(documents));
                createNewDocument();
                loadDocumentList();
            }
        }

        // Initialize empty document
        createNewDocument();
    </script>
</body>
</html>